(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1764"],{"45c0":function(t,e,n){"use strict";n.r(e),n.d(e,"AUTOMATICPAYMENT_MODULE_NAME",(function(){return T}));var a,r=n("bd86"),c=(n("96cf"),n("3b8d")),o=(n("7514"),n("b756")),i="SET_LISTPAYMENTS",u="SET_PAYMENT_SELECTED",m="SET_PAYMENT_LIST_PAGE",s="SET_ACCOUNTCHARGE_PRIMARY",d="SET_ACCOUNTCHARGE_SECONDARY",f="SET_EDITFORM_DATA",y="SET_SHOWSAVED_MESSAGE",l="SET_OPERATION_DATA",h="SET_DELETED_ITEM",p="DELETE_PAYMENT",P="SET_SMS_TOKEN_AUTOMATIC_PAYMENT",g={dataAdobe:"",paymentSelected:"",paymentListPage:1,listPayments:[],listPaymentsLoaded:!1,updatedPayment:!1,accountsChargePrimary:[],accountsChargeSecondary:[],deleteForm:{operationData:{},item:!1},editForm:{accountChargePrimary:"",accountChargeSecondary:"",maxAmount:""},smsTokenDataAutomaticPayment:""},A={getPaymentSelected:function(t){return t.listPayments.find((function(e){return e.suscriptionCode===t.paymentSelected}))||{}}},S={getSmsTokenAutomaticPayment:function(t,e){var n=t.commit;return new Promise((function(t,a){o["a"].getSmsTokenAutomaticPayment(e).then((function(e){var a=e.data;n(P,a),t()})).catch((function(t){return a(t)}))}))},showModalError:function(t,e){var n=t.dispatch;n("app/dynamicModal/showModal",{type:"error",componentProps:{error:{message:e.message}}},{root:!0})},setPaymentSelected:function(t,e){var n=t.commit;n(u,e)},setPaymentListPage:function(t,e){var n=t.commit;n(m,e)},getListPayments:function(t,e){var n=t.commit;return o["a"].listPayments(e).then((function(t){n(i,t.data.subscriptions)}))},setAmountMax:function(t,e){var n=t.commit;n(f,{field:"maxAmount",value:e})},resetFormData:function(t){var e=t.commit;e(f,{field:"accountChargePrimary",value:""}),e(f,{field:"accountChargeSecondary",value:""}),e(f,{field:"maxAmount",value:0})},setInitialData:function(t){var e=t.getters,n=t.commit,a=t.dispatch;return new Promise((function(t){a("loadAccountCharge").then(Object(c["a"])(regeneratorRuntime.mark((function r(){var c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(c=e.getPaymentSelected,!c.principalProductIndex){r.next=4;break}return r.next=4,a("setAccountChargePrimary",c.principalProductIndex);case 4:return r.next=6,a("loadAccountChargeSecondary");case 6:if(!c.secondaryProductIndex){r.next=9;break}return r.next=9,a("setAccountChargeSecondary",c.secondaryProductIndex);case 9:n(f,{field:"maxAmount",value:c.maxAmount}),t(!0);case 11:case"end":return r.stop()}}),r)}))))}))},setAccountChargePrimary:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,a,r,c,o,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,a=e.commit,r=e.getters,c=e.dispatch,e.rootGetters,o=i.length>1&&void 0!==i[1]&&i[1],a(f,{field:"accountChargePrimary",value:n.accountsChargePrimary.find((function(t){return t.id===o}))?o:""}),t.next=5,c("loadAccountChargeSecondary");case 5:if(o!==n.editForm.accountChargeSecondary){t.next=9;break}a(f,{field:"accountChargeSecondary",value:""}),t.next=12;break;case 9:if(!r.getPaymentSelected.secondaryProductIndex){t.next=12;break}return t.next=12,c("setAccountChargeSecondary",r.getPaymentSelected.secondaryProductIndex);case 12:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),setAccountChargeSecondary:function(t){t.state;var e=t.commit,n=(t.dispatch,t.rootGetters,arguments.length>1&&void 0!==arguments[1]&&arguments[1]);e(f,{field:"accountChargeSecondary",value:n})},testing:function(t){var e=t.commit;e(f,{field:"accountChargeSecondary",value:""})},loadAccountCharge:function(t){var e=t.commit,n=t.dispatch;return new Promise((function(t,a){n("getAccountCharge",{operationType:"AUTOMATIC_PAYMENT"},{root:!0}).then((function(n){e(s,n.products),t(!0)})).catch((function(t){n("showModalError",t),a(t)}))}))},loadAccountChargeSecondary:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,a=e.state,t.abrupt("return",new Promise((function(t){var e=a.accountsChargePrimary;a.editForm.accountChargePrimary&&(e=a.accountsChargePrimary.filter((function(t){return t.id!==a.editForm.accountChargePrimary}))),n(d,e),t(!0)})));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),updatePayment:function(t,e){var n=t.state,a=(t.getters,t.commit),r=t.dispatch;return new Promise((function(t){o["a"].updatePayment({subscriptionCode:n.paymentSelected,maxAmount:e.checkAmountMax?n.editForm.maxAmount:0,principalAccountIndex:n.editForm.accountChargePrimary,secondaryAccountIndex:n.editForm.accountChargeSecondary,authToken:e.authToken,salt:e.salt}).then((function(n){e.checkAmountMax||a(f,{field:"maxAmount",value:0}),a(y,!0),r("getListPayments"),t(n)})).catch((function(e){r("showModalError",e),t(!1)}))}))},unsuscribePayment:function(t,e){var n=t.commit,a=t.getters,r=t.state,i=t.dispatch;return new Promise(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o["a"].unsubscribe({subscriptionCode:r.paymentSelected}).then((function(t){e(!0),n(h,a.getPaymentSelected),n(p,{tracking:t.trackingId,code:t.trackingId,date:t.data.operationDate,time:t.data.operationTime}),i("getListPayments")})).catch((function(t){i("showModalError",t),e(!1)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},setUpdatedPayment:function(t,e){var n=t.commit;n(y,e)}},C=(a={dataAdobe:function(t,e){t.dataAdobe=e}},Object(r["a"])(a,i,(function(t,e){t.listPayments=e})),Object(r["a"])(a,m,(function(t,e){t.paymentListPage=e})),Object(r["a"])(a,u,(function(t,e){t.paymentSelected=e})),Object(r["a"])(a,s,(function(t,e){t.accountsChargePrimary=e})),Object(r["a"])(a,d,(function(t,e){t.accountsChargeSecondary=e})),Object(r["a"])(a,f,(function(t,e){t.editForm[e.field]=e.value})),Object(r["a"])(a,y,(function(t,e){t.updatedPayment=e})),Object(r["a"])(a,l,(function(t,e){t.deleteForm.operationData=e})),Object(r["a"])(a,h,(function(t,e){t.deleteForm.item=e})),Object(r["a"])(a,p,(function(t,e){t.listPayments=t.listPayments.filter((function(e){return e.suscriptionCode!==t.paymentSelected})),t.deleteForm.operationData=e})),Object(r["a"])(a,P,(function(t,e){t.smsTokenDataAutomaticPayment=e})),a),T="automaticPayment";e["default"]={automaticPayment:{namespaced:!0,state:g,getters:A,actions:S,mutations:C}}}}]);